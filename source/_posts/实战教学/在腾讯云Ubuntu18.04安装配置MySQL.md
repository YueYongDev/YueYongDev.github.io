---
title: åœ¨è…¾è®¯äº‘ Ubuntu18.04 å®‰è£…é…ç½® MySQL 5.7ï¼ˆè¸©å‘è­¦å‘Šâš ï¸ï¼‰
categories:
  - å®æˆ˜æ•™å­¦
tags:
  - æ•°æ®åº“
abbrlink: "7980"
---

![](http://ww2.sinaimg.cn/large/006tNc79ly1g5x0th0e8jj31mi0tc7ea.jpg)

## å‰è¨€

å’Œæ ‡é¢˜ä¸€æ ·ï¼Œæœ¬æ–‡çš„ä¸»è¦å†…å®¹å°±æ˜¯åœ¨è…¾è®¯äº‘ Ubuntu18.04 ä¸Šå®‰è£…é…ç½® MySQL 5.7ï¼Œä¹‹æ‰€ä»¥è¦å†™è¿™ç¯‡æ–‡ç« æ˜¯å› ä¸ºå‰ä¸¤å¤©å’Œæœ‹å‹è®¨è®ºç°åœ¨çš„ mysql è®¾ç½® root è´¦æˆ·çš„å¯†ç ä¸Šå’Œä»¥å‰ä¸ä¸€æ ·äº†è€Œä¸”åç»­çš„æ“ä½œä¹Ÿæ¯”ä»¥å‰éº»çƒ¦äº†ï¼Œä»–ä¸ä¿¡ç›¸ä¿¡ï¼Œç„¶åä¸ºäº†å‘ä»–éªŒè¯æˆ‘çš„è¯´æ³•ï¼Œæˆ‘å°±æŠŠæˆ‘çš„ä¸€å°æš‚æ—¶é—²ç½®çš„è…¾è®¯äº‘æœåŠ¡å™¨é‡è£…äº†ä¸‹ç³»ç»Ÿï¼ˆç¨‹åºå‘˜è¾ƒèµ·çœŸæ¥å°±æ˜¯è¿™ä¹ˆä¸è®²ç† ğŸ˜œï¼‰

![](http://ww2.sinaimg.cn/bmiddle/006tNc79ly1g5wwtpbjojj30si0s00zo.jpg)

è¿™ä¸ï¼Œè™½ç„¶æˆ‘è¯å®äº†æˆ‘è¯´çš„ï¼Œä½†æˆ‘ä¹Ÿä»˜å‡ºäº†è¦é‡æ–°é…ç½®æˆ‘è¿™å°æœåŠ¡å™¨çš„æƒ¨ç—›ä»£ä»·ï¼Œæ—¢ç„¶è¿™æ ·å€’ä¸å¦‚æŠŠå®‰è£…é…ç½®çš„è¿‡ç¨‹è®°å½•ä¸‹ã€‚è¯ä¸å¤šè¯´ï¼Œæˆ‘ä»¬å°±å¼€å§‹å§ã€‚

## ç¯å¢ƒå‡†å¤‡

- ä¸€å°è…¾è®¯äº‘æœåŠ¡å™¨
- ç³»ç»Ÿç¯å¢ƒä¸º Ubuntu 18.04

## å®‰è£…

å®‰è£… mysql éå¸¸ç®€å•ï¼Œåªéœ€è¦æ‰§è¡Œä¸‹é¢ä¸¤ä¸ªå‘½ä»¤ï¼š

```bash
sudo apt-get install mysql-server
sudo apt-get install mysql-client
```

æ£€æŸ¥ MySQL æ˜¯å¦è¿è¡Œï¼š

```bash
sudo netstat -tap | grep mysql
```

å¦‚æœæˆåŠŸå®‰è£…ï¼Œæˆ‘çš„ä¼šæ˜¾ç¤ºå¦‚ä¸‹å†…å®¹ï¼š

```bash
tcp6       0      0 [::]:1030               [::]:*                  LISTEN      5743/mysqld
```

é¡ºä¾¿åœ¨è¿™é‡Œæä¸€ä¸‹ **é‡å¯/æ‰“å¼€/å…³é—­ MySQL ** çš„æ–¹æ³•æ˜¯ï¼š

```bash
sudo service mysql restart/start/stop
```

## é…ç½®

è™½ç„¶æˆ‘ä»¬å¯ä»¥é€šè¿‡æ‰§è¡Œä¸¤ä¸ªå‘½ä»¤å°±èƒ½å¾ˆæ–¹ä¾¿çš„å®‰è£…å¥½ MySQLï¼Œä½†æ˜¯æˆ‘åœ¨å®‰è£…è¿‡ç¨‹ä¸­å¹¶æ²¡æœ‰å‡ºç°è¦æˆ‘å†™ç”¨æˆ·åå’Œå¯†ç çš„åœ°æ–¹ï¼Œè¿™è®©æˆ‘ä¸€è„¸æ‡µé€¼ï¼Œç´¢æ€§åœ¨ç»ˆç«¯è¾“å…¥`mysql -u root -p`ä¹‹åï¼Œè¦æ±‚æˆ‘è¾“å…¥å¯†ç ï¼Œå¯æ˜¯æˆ‘å¹¶ä¸çŸ¥é“å¯†ç ï¼Œå¿ƒæƒ³å¯èƒ½é»˜è®¤å¯†ç å°±æ˜¯ç©ºå§ï¼Œç›´æ¥å›è½¦ä¸å¯¹ï¼Œéšä¾¿è¾“å…¥ä¸€ä¸ªå¯†ç ä¹Ÿä¸å¯¹ï¼Œç»ˆäºåœ¨æŸ¥æ‰¾äº†å¾ˆå¤šèµ„æ–™åï¼Œæˆ‘æ‰¾åˆ°äº†è§£å†³æ–¹æ¡ˆã€‚

### æŸ¥çœ‹åˆå§‹ç”¨æˆ·åå’Œå¯†ç 

æŸ¥çœ‹ä¸€ä¸ªæ–‡ä»¶

```bash
sudo cat /etc/mysql/debian.cnf
```

åœ¨è¿™ä¸ªæ–‡ä»¶é‡Œé¢æœ‰ç€ MySQL é»˜è®¤çš„ç”¨æˆ·åå’Œç”¨æˆ·å¯†ç ï¼Œ
æœ€æœ€é‡è¦çš„æ˜¯ï¼šç”¨æˆ·åé»˜è®¤çš„ä¸æ˜¯ rootï¼Œè€Œæ˜¯ debian-sys-maintï¼Œå¦‚ä¸‹æ‰€ç¤º

```bash
# Automatically generated for Debian scripts. DO NOT TOUCH!
[client]
host     = localhost
user     = debian-sys-maint
password = skFz7zS0Fl1t2QHK
socket   = /var/run/mysqld/mysqld.sock
[mysql_upgrade]
host     = localhost
user     = debian-sys-maint
password = skFz7zS0Fl1t2QHK
socket   = /var/run/mysqld/mysqld.sock
```

è®°ä¸‹è¿™é‡Œçš„ **_user_** å’Œ **_password_**ï¼Œç„¶ååˆ°ç»ˆç«¯é‡Œè¾“å…¥ `mysql -u debian-sys-maint -p `ï¼Œéšå³ä¼šè®©æˆ‘ä»¬è¾“å…¥å¯†ç ï¼Œæ­¤æ—¶è¾“å…¥æˆ‘ä»¬åˆšæ‰è®°ä¸‹çš„å¯†ç å³å¯è¿›å…¥ mysql çš„ shell ç¯å¢ƒäº†ã€‚

### æ›´æ”¹è®¿é—®è´¦æˆ·å’Œå¯†ç 

æ¯æ¬¡éƒ½è¿™ä¹ˆç™»å½•è‡ªç„¶å¾ˆéº»çƒ¦ï¼Œå› æ­¤å…ˆæƒ³åˆ°äº†æ›´æ”¹ root å¯†ç ï¼š

```mysql
mysql> update mysql.user set authentication_string=password('password') where user='root'and Host = 'localhost';
```

> Tips:è¿™é‡Œè¯´æ˜ä¸‹ï¼Œåœ¨ MySQL 5.7 password å­—æ®µå·²ä»`mysql.user`è¡¨ä¸­åˆ é™¤ï¼Œæ–°çš„å­—æ®µåæ˜¯`authenticalion_string`ã€‚

ç„¶åä½ ä»¥ä¸ºåœ¨ç»ˆç«¯è¾“å…¥`mysql -u root -p`ï¼Œç„¶åå†è¾“å…¥ä½ åˆšæ‰è®¾ç½®çš„å¯†ç å°±å¯ä»¥è®¿é—®äº†å—ï¼Ÿ

![](http://ww1.sinaimg.cn/large/006tNc79ly1g5wxjbrmjaj30f708cglv.jpg)

å¤©çœŸï¼Œæ€ä¹ˆä¼šé‚£ä¹ˆç®€å•ï¼Œæƒ³è¦æˆé•¿ï¼Œæ€ä¹ˆèƒ½ä¸è¢«æ— æƒ…çš„ç°å®è¹‚èºä¸€ç•ªã€‚

![](http://ww2.sinaimg.cn/large/006tNc79ly1g5wxg7dpxxj30ve0300ta.jpg)

å¯æˆ‘æ˜æ˜å°±å·²ç»æ”¹è¿‡å¯†ç äº†ï¼Œä¸ºå•¥è¿˜æ˜¯ç™»é™†ä¸è¿›å»ã€‚

äºæ˜¯æˆ‘åˆå¼€å§‹åœ¨åº¦å¨˜ä¸Šæœç´¢ï¼Œç»ˆäºæ‰¾åˆ°äº†é—®é¢˜çš„åŸå› ï¼š

> åŸå› æ˜¯å› ä¸ºåœ¨æœ€è¿‘çš„ Ubuntu å®‰è£…ï¼ˆå½“ç„¶ä¹Ÿå¯èƒ½æ˜¯å…¶ä»–å®‰è£…ï¼‰ä¸­ï¼ŒMySQL é»˜è®¤ä½¿ç”¨äº†`UNIX auth_socket plugin`æ’ä»¶ã€‚
>
> ç®€å•æ¥è¯´è¿™æ„å‘³ç€å½“`db_users`ä½¿ç”¨æ•°æ®åº“æ—¶ï¼Œ**å°†ä¼šé€šè¿‡ç³»ç»Ÿç”¨æˆ·è®¤è¯è¡¨è¿›è¡Œè®¤è¯**ã€‚

ä½ å¯ä»¥é€šè¿‡ä¸‹é¢çš„å‘½ä»¤çœ‹çœ‹ä½ çš„ root ç”¨æˆ·æ˜¯å¦è®¾ç½®æˆäº†è¿™æ ·ï¼š

```
mysql> USE mysql;
mysql> SELECT User, Host, plugin FROM mysql.user;

+------------------+-----------------------+
| User             | plugin                |
+------------------+-----------------------+
| root             | auth_socket           |
| mysql.sys        | mysql_native_password |
| debian-sys-maint | mysql_native_password |
+------------------+-----------------------+
```

å¦‚æœæ˜¯è¿™æ ·çš„è¯å°±è¯´æ˜ root ç”¨æˆ·æ­£åœ¨ä½¿ç”¨`auth_socket`æ’ä»¶ï¼Œå¯¹äºè¿™ç§é—®é¢˜ï¼Œæœ‰ä¸¤ç§è§£å†³æ–¹æ¡ˆï¼š

1. **è®¾ç½®ä½ çš„ root ç”¨æˆ·ä½¿ç”¨ mysql_native_password æ’ä»¶**

2. **åˆ›å»ºä¸€ä¸ªä¸ä½ çš„ç³»ç»Ÿç”¨æˆ·ä¸€è‡´çš„æ–°çš„æ•°æ®åº“ç”¨æˆ·ï¼ˆæ¨èï¼‰**

#### **è®¾ç½® root ç”¨æˆ·ä½¿ç”¨ mysql_native_password æ’ä»¶**

å› ä¸ºä¸æ¨èé‡‡ç”¨è¿™ç§æ–¹å¼ï¼Œæ‰€ä»¥è¿™é‡Œåªæ˜¯ç»™å‡ºè¦æ‰§è¡Œçš„å‘½ä»¤ï¼š

```mysql
mysql> use mysql;
mysql> update user set plugin='mysql_native_password' where user='root';
mysql> alter user 'root'@'localhost' identified by '123456';
mysql> FLUSH PRIVILEGES;
mysql> exit;
```

#### åˆ›å»ºä¸€ä¸ªæ–°ç”¨æˆ·

é‡ç‚¹æ¥è¯´ä¸‹è¿™ç§æ–¹å¼ã€‚ä¹‹æ‰€ä»¥è¦æ–°å»ºä¸€ä¸ªç”¨æˆ·ï¼Œä¸å•å•æ˜¯ä¸ºäº†è§£å†³ä¿®æ”¹ root è´¦æˆ·å¯†ç çš„æƒ…å†µã€‚æˆ‘ä»¬çŸ¥é“ï¼Œå½“ä¸€ä¸ªé¡¹ç›®çš„ä½“é‡ä¸Šå»äº†ï¼Œæ•°æ®åº“çš„ç»´æŠ¤å°±å˜å¾—éå¸¸é‡è¦äº†ï¼Œå¦‚æœå‘å±•åˆ°ä¸€å®šç¨‹åº¦åç”¨æˆ·åä»ç„¶æ˜¯ rootï¼ˆå¦‚æœè¿™æ—¶å€™è¿˜å¼€é€šäº†å¤–ç½‘è®¿é—®ï¼‰ï¼Œé‚£å®‰å…¨æ€§å°±ä¼šå¤§å¤§é™ä½ã€‚å†µä¸”æ¯ä¸ªé¡¹ç›®çš„å¼€å‘äººå‘˜è‚¯å®šä¸æ­¢ä¸€ä¸ªï¼Œä¸åŒ coder çš„æƒé™ç­‰çº§ä¹Ÿä¸ä¸€æ ·ï¼Œèƒ½å¯¹æ•°æ®åº“è¿›è¡Œçš„æ“ä½œè‚¯å®šä¹Ÿæ˜¯ä¸ä¸€æ ·çš„ã€‚æ‰€ä»¥ç»¼ä¸Šæ‰€è¿°ï¼Œæˆ‘ä¾æ—§æ¨èåœ¨åˆšå¼€å§‹å®‰è£… mysql æ—¶å°±æ–°å»ºä¸€ä¸ªç”¨æˆ·è¿›è¡Œé…ç½®ã€‚

**å‘½ä»¤ï¼š**

```
CREATE USER 'username'@'host' IDENTIFIED BY 'password';
```

**è¯´æ˜ï¼š**

- usernameï¼šä½ å°†åˆ›å»ºçš„ç”¨æˆ·å
- hostï¼šæŒ‡å®šè¯¥ç”¨æˆ·åœ¨å“ªä¸ªä¸»æœºä¸Šå¯ä»¥ç™»é™†ï¼Œå¦‚æœæ˜¯æœ¬åœ°ç”¨æˆ·å¯ç”¨ localhostï¼Œå¦‚æœæƒ³è®©è¯¥ç”¨æˆ·å¯ä»¥**ä»ä»»æ„è¿œç¨‹ä¸»æœºç™»é™†**ï¼Œå¯ä»¥ä½¿ç”¨é€šé…ç¬¦`%`
- passwordï¼šè¯¥ç”¨æˆ·çš„ç™»é™†å¯†ç ï¼Œå¯†ç å¯ä»¥ä¸ºç©ºï¼Œå¦‚æœä¸ºç©ºåˆ™è¯¥ç”¨æˆ·å¯ä»¥ä¸éœ€è¦å¯†ç ç™»é™†æœåŠ¡å™¨

**ä¸¾ä¾‹ï¼š**

å¦‚æœæˆ‘æƒ³åˆ›å»ºä¸€ä¸ªç”¨æˆ·åä¸º"lyy"ï¼Œå¯†ç ä¸º 123456ï¼Œä¸”**å…è®¸ä»ä»»æ„è¿œç¨‹ä¸»æœºç™»é™†**ï¼Œå¯ä»¥æ‰§è¡Œä¸‹é¢è¿™æ¡å‘½ä»¤ï¼š

```mysql
CREATE USER 'lyy'@'%' IDENTIFIED BY '123456';
```

#### ç»™æ–°åˆ›å»ºçš„ç”¨æˆ·æˆæƒ

**å‘½ä»¤ï¼š**

```
GRANT privileges ON databasename.tablename TO 'username'@'host'
```

**è¯´æ˜ï¼š**

- privilegesï¼šç”¨æˆ·çš„æ“ä½œæƒé™ï¼Œå¦‚`SELECT`ï¼Œ`INSERT`ï¼Œ`UPDATE`ç­‰ï¼Œå¦‚æœè¦æˆäºˆæ‰€çš„æƒé™åˆ™ä½¿ç”¨`ALL`
- databasenameï¼šæ•°æ®åº“å
- tablenameï¼šè¡¨åï¼Œå¦‚æœè¦æˆäºˆè¯¥ç”¨æˆ·å¯¹æ‰€æœ‰æ•°æ®åº“å’Œè¡¨çš„ç›¸åº”æ“ä½œæƒé™åˆ™å¯ç”¨`*`è¡¨ç¤ºï¼Œå¦‚`*.*`

**ä¾‹å­ï¼š**

```mysql
GRANT SELECT, INSERT ON test.user TO 'lyy'@'%';
GRANT ALL ON *.* TO 'lyy'@'%';
```

è¿™æ ·æˆ‘ä»¬åœ¨å›åˆ° shell ç¯å¢ƒä¸­ï¼Œæ‰§è¡Œ`mysql -u lyy -p`ç„¶åè¾“å…¥å¯†ç å°±å¯ä»¥è¿›å…¥ mysql çš„ shell ç¯å¢ƒäº†ã€‚

> Tipsï¼šå¦‚æœæƒ³è¦æ›´æ–°æŸä¸ªç”¨æˆ·çš„å¯†ç åªéœ€è¦æ‰§è¡Œï¼š
>
> ```
> update user set authentication_string=password('password') where user='username' and host='host';
> ```

### è®¾ç½® mysql å¯ä»¥å¤–ç½‘è®¿é—®

åœ¨ä½¿ç”¨ mysql çš„è¿‡ç¨‹ä¸­ï¼Œæˆ‘ä»¬å¾€å¾€éƒ½ä¼šä½¿ç”¨ Navicat ç­‰å·¥å…·å¯¹æ•°æ®åº“è¿›è¡Œå¯è§†åŒ–ç®¡ç†ï¼Œè¿™æ—¶å°±éœ€è¦è®¾ç½® mysql å¤–ç½‘è®¿é—®äº†ã€‚

è®¾ç½®è¿‡ç¨‹åˆ†ä¸ºä¸¤æ­¥ï¼š

1. è®¾ç½®ç”¨æˆ·å¯ä»¥**ä»ä»»æ„è¿œç¨‹ä¸»æœºç™»é™†**
2. ä¿®æ”¹é…ç½®æ–‡ä»¶ï¼Œæ³¨é‡Šæ‰ `bind_ip_address`

ç¬¬ä¸€æ­¥åœ¨ä¸Šé¢å·²ç»è¯´è¿‡äº†ï¼Œè¿™é‡Œæ¥è¯´ä¸‹ç¬¬äºŒæ­¥ï¼š

mysql 5.7 çš„é…ç½®æ–‡ä»¶è·¯å¾„åœ¨ï¼š`/etc/mysql/mysql.conf.d/mysqld.cnf`ï¼Œå½“æˆ‘ä»¬æ‰§è¡Œ`sudo cat /etc/mysql/mysql.conf.d/mysqld.cnf`å‘½ä»¤æ—¶ç»“æœå¦‚ä¸‹æ‰€ç¤ºï¼š

![](http://ww2.sinaimg.cn/large/006tNc79ly1g5wzesj2e2j30zq0pkjva.jpg)

åœ¨`bind-address`å‰æ·»åŠ `#`æ³¨é‡Šæ‰è¯¥è¡Œå³å¯ã€‚

> Tipsï¼šå‡ºäºå®‰å…¨è€ƒè™‘ï¼Œå¦‚æœæˆ‘ä»¬æƒ³è¦ä¿®æ”¹ mysql çš„å¯åŠ¨ç«¯å£ï¼Œå¯ä»¥ä¿®æ”¹ä¸Šè¿°å›¾ç‰‡ä¸­çš„ **port** éƒ¨åˆ†ä¸ºè‡ªå·±æƒ³è¦çš„ç«¯å£å·ã€‚

åœ¨è¿™ä¸€åˆ‡éƒ½å¼„å¥½ä¹‹ååˆ«å¿˜äº†é‡æ–°å¯åŠ¨ä¸‹ mysql å“¦ ğŸ˜¯

```bash
sudo service restart mysql
```

## è¿æ¥åˆ° MySQL

è¿™é‡Œæˆ‘ä»¬ä½¿ç”¨ Navicat è¿æ¥åˆ° mysqlï¼Œå…¶å®æ­¥éª¤å¾ˆç®€å•ï¼Œæ‰“å¼€è½¯ä»¶->æ–°å»ºé“¾æ¥->ç¼–è¾‘ä¿¡æ¯å°±å¯ä»¥äº†ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š

![WX20190812-164325@2x](http://ww2.sinaimg.cn/large/006tNc79ly1g5wzr04welj30ok0d4ta4.jpg)

è‡³äºæ€ä¹ˆä¸‹è½½å®‰è£…ç ´è§£ Navicat è¿™é‡Œå°±ä¸å¤šè¯´äº†ã€‚

## åˆ é™¤ mysql

æœ€åè¯´ä¸‹å¦‚ä½•å¸è½½ mysql

```bash
sudo apt-get autoremove --purge mysql-server-5.7
sudo apt-get remove mysql-server
sudo apt-get autoremove mysql-server
sudo apt-get remove mysql-common
```

ä¸Šé¢çš„å¯èƒ½ä¼šæœ‰äº›æ˜¯å¤šä½™çš„ï¼Œä¹‹åéœ€è¦æ¸…ç†æ®‹ä½™æ•°æ®

```bash
 dpkg -l |grep ^rc|awk '{print $2}' |sudo xargs dpkg -P
```

---

![](http://ww1.sinaimg.cn/large/006tNc79ly1g5x01onq5yj31970oxq5a.jpg)
